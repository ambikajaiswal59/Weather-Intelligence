<div>
  <!-- Map Show -->
<div class="container-fluid full-height-container" style="margin-bottom: 20px;">
  <div class=" data-map-div  row g-4 align-items-stretch h-100">
    <!-- Left Panel -->
    <div class=" weather-panel col-lg-5 col-md-6 d-flex flex-column">
      <div class="equal-height-panel">
        <h5 class="text-success mb-2">
          {{ location?.name }}, {{ location?.region }}
          <span class="weather-station">(Weather Station)</span>
        </h5>

        <div class="mx-2 card flex-grow-1 p-3" style="background-color: #e6ffe6; border: 1px solid #b2f0b2;">
          <p class="text-muted fw-bold mb-1">TODAY’S WEATHER</p>
          <p class="text-secondary solid mb-3">{{ currentTime }}</p>

          <div class="d-flex align-items-center mb-3">
            <img [src]="'https:' + current?.condition?.icon" alt="weather-icon" width="48" class="me-3" />
            <h1 class="display-5 fw-semibold mb-0">{{ current?.temp_c }}°C</h1>
          </div>

          <p class="lead mb-4">{{ current?.condition?.text }}</p>

          <div class=" weather-info-card d-flex flex-wrap justify-content-between text-muted small">
            <!-- Weather Stats -->
            <div class="weather-detail p-2">
              <i class="fa-solid fa-temperature-half me-2 text-dark fs-4"></i>
              Feels Like: <strong>{{ current?.feelslike_c }}°C</strong>
            </div>
            <div class="weather-detail p-2">
              <i class="fa-solid fa-droplet text-primary me-2 fs-4"></i>
              Humidity: <strong>{{ current?.humidity }}%</strong>
            </div>
            <div class="weather-detail p-2">
              <i class="fa-solid fa-wind me-2 text-info fs-4"></i>
              Wind: <strong>{{ current?.wind_kph }} km/h</strong>
            </div>
            <div class="weather-detail p-2">
              <i class="fa-solid fa-compass me-2 text-secondary fs-4"></i>
              Wind Dir: <strong>{{ current?.wind_dir }}</strong>
            </div>
            <div class="weather-detail p-2">
              <i class="fa-solid fa-gauge-high  text-danger fs-4"></i>
              Pressure: <strong>{{ current?.pressure_mb }} mb</strong>
            </div>
            <div class="weather-detail p-2">
              <i class="fa-solid fa-eye me-2 text-warning fs-4"></i>
              Visibility: <strong>{{ current?.vis_km }} km</strong>
            </div>
            <div class="weather-detail p-1">
              <i class="fa-solid fa-sun me-1 text-warning fs-4"></i>
              UV Index: <strong>{{ current?.uv }}</strong>
            </div>
            <div class="weather-detail p-2">
              <i class="fa-solid fa-fire mx-2 text-danger fs-4"></i>
              Heat Index: <strong>{{ current?.heatindex_c }}°C</strong>
            </div>
          </div>

          <p class="small mt-4 text-start">
            <strong>Last Updated:</strong> {{ lastUpdatedTime }}
            <i class="fa-solid fa-rotate-right ms-2" role="button" style="cursor: pointer;"
              (click)="fetchWeatherData()" [class.fa-spin]="loading"></i>
          </p>
        </div>
      </div>
    </div>

    <!-- Right Panel -->
    <div class=" map-panel col-lg-7 col-md-6 d-flex flex-column">
      <div class="equal-height-panel">
        <!-- Filter Buttons -->
       <div class=" weather-filters-button   d-flex justify-content-between  gap-2 mb-3 responsive-button-group">
          <button class="btn btn-success btn-sm px-2 py-1 text-nowrap d-flex align-items-center justify-content-center gap-1 flex-grow-1">
            <i class="fas fa-temperature-high"></i> Temperature
          </button>
         <button class="btn btn-success btn-sm px-2 py-1 text-nowrap d-flex align-items-center justify-content-center gap-1 flex-grow-1">
            <i class="fas fa-cloud-showers-heavy"></i> Rainfall
          </button>
          <button class="btn btn-success btn-sm px-2 py-1 text-nowrap d-flex align-items-center justify-content-center gap-1 flex-grow-1">
            <i class="fas fa-wind"></i> Wind Speed
          </button>
          <button class="btn btn-success btn-sm px-2 py-1 text-nowrap d-flex align-items-center justify-content-center gap-1 flex-grow-1">
            <i class="fas fa-tint"></i> Humidity
          </button>
        </div>

        <!-- Map Component -->
        <div class="flex-grow-1">
          <app-map-weather></app-map-weather>
        </div>
      </div>
    </div>
  </div>
</div>


  <div class="accordion" id="dashboardAccordion">
    <!-- Hourly Weather Accordion Item -->
    <div class="accordion-item">
      <h2 class="accordion-header" id="headingHourly">
        <button class="accordion-button" [class.collapsed]="activeAccordion !== 'hourly'"
          (click)="toggleAccordion('hourly')" [attr.aria-expanded]="activeAccordion === 'hourly'">
          Hourly Weather
        </button>
      </h2>

      <!-- Accordion Collapsible Body -->
      <div id="collapseHourly" class="accordion-collapse collapse" [class.show]="activeAccordion === 'hourly'"
        aria-labelledby="headingHourly">
        <div class="accordion-body position-relative bg-white">

          <!-- <div class="mb-3 text-center">
            <h4>{{ location?.name }}, {{ location?.country }}</h4>
            <p>{{ current?.condition?.text }} | {{ current?.temp_c }}°C</p>
          </div> -->

          <!-- Hourly Timeline -->
          <div class="position-relative bg-white">

            <!-- Scroll Arrows -->
            <button *ngIf="activeAccordion === 'hourly' && !atScrollStart && hourlyData?.length"
              class="btn btn-light shadow-sm position-absolute top-50 start-0 translate-middle-y rounded-circle"
              style="z-index: 10; border: 1px solid #ced4da;" (click)="scrollLeft()">
              <i class="fas fa-chevron-left text-secondary"></i>
            </button>

            <!-- Right Scroll Button -->
            <button *ngIf="activeAccordion === 'hourly' && !atScrollEnd && hourlyData?.length"
              class="btn btn-light shadow-sm position-absolute top-50 end-0 translate-middle-y rounded-circle"
              style="z-index: 10; border: 1px solid #ced4da;" (click)="scrollRight()">
              <i class="fas fa-chevron-right text-secondary"></i>
            </button>

            <!-- Scrollable Timeline -->
            <div *ngIf="activeAccordion === 'hourly' && (hourlyData?.length || 0) > 0">
              <div #scrollContainer class="d-flex overflow-auto gap-3 px-2 pt-2 pb-1" style="scroll-behavior: smooth; ">
                <div *ngFor="let hour of hourlyData"
                  class="flex-shrink-0 bg-white border border-success rounded p-3 text-center shadow-sm"
                  style="min-width: 110px; ">
                  <div class="text-success fw-semibold small mb-2">{{ hour.time }}</div>
                  <img [src]="'https:' + hour.icon" alt="icon" width="40" height="40" class="mb-2" />
                  <div class="fw-bold text-success mb-1">{{ hour.temp }}°C</div>
                  <div class="text-muted small">
                    <div class="text-muted small">🌧️ {{ hour.chanceOfRain }}% chance of rain</div>
                    <i class="fas fa-cloud-showers-heavy me-1 text-primary"></i> {{ hour.rain }} mm<br />
                    <i class="fas fa-wind me-1 text-info"></i> {{ hour.wind }} km/h
                  </div>
                </div>
              </div>
            </div>

          </div>

        </div>
      </div>
    </div>
    <!-- 7 Days Forecast -->
    <div class="accordion-item">
      <h2 class="accordion-header" id="headingForecast">
        <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse"
          data-bs-target="#collapseForecast" aria-expanded="false" aria-controls="collapseForecast"
          (click)="toggleForecast()">
          7-Day Weather Forecast
        </button>
      </h2>
      <div id="collapseForecast" class="accordion-collapse collapse">
        <div class="accordion-body p-3">

          <!-- Scrollable Weather Cards -->
          <div class="d-flex overflow-auto gap-3 py-2 px-1" *ngIf="weatherData && weatherData.length > 0">
            <div class="card text-center flex-shrink-0 shadow-sm"
              style="min-width: 250px; border-color: green; background-color: #e7f3df;" *ngFor="let day of weatherData">
              <div class="card-body p-3">
                <div class="fw-semibold mb-1">{{ day.date }}</div>
                <div class="d-flex justify-content-between mb-2">
                  <span class="text-primary">min: {{ day.minTemp }}°C</span>
                  <span class="text-primary">max: {{ day.maxTemp }}°C</span>
                </div>
                <img [src]="'https:' + day.icon" [alt]="day.description" width="36" height="36" class="mb-2" />

                <div class="text-muted small">{{ day.description }}</div>

                <div class="text-muted small">🌧️ {{ day.chanceOfRain }}% chance of rain</div>
                <div class="text-muted small">
                  <i class="fas fa-droplet" style="color: #3498db;"></i> Humidity: {{ day.humidity }}%
                </div>

              </div>
            </div>
          </div>

        </div>
      </div>
    </div>
    <!-- Hazards / Bad Weather -->
    <div class="accordion-item">
      <h2 class="accordion-header" id="headingHazards">
        <button id="hazardsAccordionButton" class="accordion-button collapsed" type="button" data-bs-toggle="collapse"
          data-bs-target="#collapseHazards" aria-expanded="false" aria-controls="collapseHazards" disabled>
          Hazards / Bad Weather
        </button>
      </h2>

      <div id="collapseHazards" class="accordion-collapse collapse" aria-labelledby="headingHazards"
        data-bs-parent="#yourAccordionId">
        <div class="accordion-body">
          <div class="panel" [style.maxHeight]="isOpen ? '600px' : '0px'">
            <!-- Dropdown Filters -->
            <div class="filters">
              <select [(ngModel)]="selectedHazard">
                <option value="">-- Select Hazard Type --</option>
                <option *ngFor="let type of hazardTypes" [value]="type">{{ type }}</option>
              </select>

              <select [(ngModel)]="selectedDistrict">
                <option value="">-- Select District --</option>
                <option *ngFor="let dist of districts" [value]="dist">{{ dist }}</option>
              </select>
            </div>

            <!-- Table Section -->
            <div *ngIf="filteredHazards.length > 0" class="table-container">
              <table>
                <thead>
                  <tr>
                    <th>State</th>
                    <th>Time</th>
                    <th>Date</th>
                    <th>Hazard Type</th>
                    <th>District</th>
                  </tr>
                </thead>
                <tbody>
                  <tr *ngFor="let hazard of filteredHazards">
                    <td>{{ hazard.state }}</td>
                    <td>{{ hazard.time }}</td>
                    <td>{{ hazard.date }}</td>
                    <td>{{ hazard.hazardType }}</td>
                    <td>{{ hazard.district }}</td>
                  </tr>
                </tbody>
              </table>
            </div>

            <!-- No Data Message -->
            <p *ngIf="(selectedHazard || selectedDistrict) && filteredHazards.length === 0">
              No data found for selected filters.
            </p>
          </div>
        </div>
      </div>
    </div>


  </div>

</div>